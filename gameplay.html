<script>
  const urlParams = new URLSearchParams(window.location.search);
  const subject = urlParams.get('subject') || "English";

  let level = "Easy";
  let levels = ["Easy", "Medium", "Hard"];
  let unlockedLevels = { Easy: true, Medium: false, Hard: false };
  let currentQuestionIndex = 0;
  let score = 0;
  let correctInLevel = 0;

  const gameTitle = document.getElementById("game-title");
  const questionText = document.getElementById("question-text");
  const optionsContainer = document.getElementById("options");
  const scoreDisplay = document.getElementById("score-display");
  const questionCount = document.getElementById("question-count");

  gameTitle.innerText = `${subject} - ${level}`;

  function loadQuestion() {
    const currentQuiz = questions[subject][level];
    if (currentQuestionIndex >= currentQuiz.length) {
      checkLevelUnlock();
      return;
    }

    const question = currentQuiz[currentQuestionIndex];
    questionText.innerText = question.q;
    questionCount.innerText = `Question ${currentQuestionIndex + 1} of ${currentQuiz.length}`;
    optionsContainer.innerHTML = '';

    question.options.forEach(option => {
      const btn = document.createElement("button");
      btn.innerText = option;
      btn.onclick = () => handleAnswer(option, question.answer);
      optionsContainer.appendChild(btn);
    });
  }

  function handleAnswer(selected, correct) {
    if (selected === correct) {
      score += 10;
      correctInLevel++;
    }

    currentQuestionIndex++;
    scoreDisplay.innerText = `Score: ${score}`;
    loadQuestion();
  }

  function checkLevelUnlock() {
    let nextLevelIndex = levels.indexOf(level) + 1;
    if (correctInLevel >= 3 && nextLevelIndex < levels.length) {
      unlockedLevels[levels[nextLevelIndex]] = true;
      alert(`You've unlocked ${levels[nextLevelIndex]} level!`);
      level = levels[nextLevelIndex];
      currentQuestionIndex = 0;
      correctInLevel = 0;
      gameTitle.innerText = `${subject} - ${level}`;
      loadQuestion();
    } else {
      questionText.innerText = "Quiz Completed!";
      optionsContainer.innerHTML = `<p>Final Score: ${score}</p>`;
    }
  }

  loadQuestion();
</script>
